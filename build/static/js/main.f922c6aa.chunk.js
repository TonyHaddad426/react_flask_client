(this.webpackJsonpreact_frontend=this.webpackJsonpreact_frontend||[]).push([[0],[,,,,,,,function(e,t,r){e.exports={user__controls:"AdminForm_user__controls__3SEI0",user__control:"AdminForm_user__control__3mEQa",user__actions:"AdminForm_user__actions__waq-P",userfilter:"AdminForm_userfilter__hne3n",userfilter__control:"AdminForm_userfilter__control__33l2N"}},,,,function(e,t,r){e.exports={backdrop:"Modal_backdrop__3R4ST",modal:"Modal_modal__2n0zs",header:"Modal_header__3txAo",h1:"Modal_h1__2T5Z-",content:"Modal_content__1Hi1R",actions:"Modal_actions__3l-__"}},function(e,t,r){e.exports={auth:"AuthForm_auth__1hc7W",title:"AuthForm_title__ILitH",control:"AuthForm_control__2-Hj8",actions:"AuthForm_actions__ITi_n",toggle:"AuthForm_toggle__2F34R"}},function(e,t,r){e.exports={user__controls:"UserForm_user__controls__1JAKX",user__control:"UserForm_user__control__39nSD",user__actions:"UserForm_user__actions__2hXiv",userfilter:"UserForm_userfilter__aC7rv",userfilter__control:"UserForm_userfilter__control__h8FQZ"}},,,function(e,t,r){e.exports={user:"ListAdminForms_user__3j_k1",title:"ListAdminForms_title__R786o",alternative:"ListAdminForms_alternative__1Miow"}},,,function(e,t,r){e.exports={filter:"Filter_filter__2AQ0O",filter__control:"Filter_filter__control__2ydhy"}},function(e,t,r){e.exports={user:"ListItems_user__SpPyk",title:"ListItems_title__2rz1F",alternative:"ListItems_alternative__26t3N"}},,,,,function(e,t,r){e.exports={card:"Card_card__3F8np"}},,function(e,t,r){e.exports={loader:"Spinner_loader__350wo",load8:"Spinner_load8__VmWFc"}},,,,,function(e,t,r){},function(e,t,r){},,function(e,t,r){},function(e,t,r){},,,,,,function(e,t,r){"use strict";r.r(t);var s=r(1),n=r.n(s),o=r(9),c=r(24),i=r.n(c),a=(r(32),r(2)),l=r(3),u=(r(33),r(0));var j=function(e){return Object(s.useState)(),Object(u.jsxs)("div",{className:"item",children:[Object(u.jsx)("div",{children:e.store}),Object(u.jsxs)("div",{className:"item__description",children:[Object(u.jsx)("h2",{children:e.title}),Object(u.jsxs)("div",{className:"item__price",children:["$",e.amount]})]})]})},d=(r(35),r(19)),m=r.n(d),h=function(e){return Object(u.jsx)("div",{className:m.a.filter,children:Object(u.jsxs)("div",{className:m.a.filter__control,children:[Object(u.jsx)("label",{children:"Sort by Price"}),Object(u.jsxs)("select",{value:e.selected,onChange:function(t){e.onChangeFilter(t.target.value)},children:[Object(u.jsx)("option",{value:"Desc",children:"High to Low"}),Object(u.jsx)("option",{value:"Asc",children:"Low to High"})]})]})})};var b,_=function(e){var t=Object(s.useState)(""),r=Object(a.a)(t,2),n=r[0],o=r[1];console.log(n);var c=e.items;return"Asc"===n&&(c=e.items.sort((function(e,t){return e.item_price-t.item_price}))),"Desc"===n&&(c=e.items.sort((function(e,t){return t.item_price-e.item_price}))),Object(u.jsxs)("div",{className:"items",children:[Object(u.jsx)(h,{selected:n,onChangeFilter:function(e){o(e)}}),c.map((function(e){return Object(u.jsx)(j,{store:e.store_name,title:e.item_name,amount:e.item_price},e.store_id+e.item_name)}))]})},O=r(15),f=r(13),x=r.n(f),g=function(e){var t=Object(s.useState)(""),r=Object(a.a)(t,2),n=r[0],o=r[1],c=Object(s.useState)(""),i=Object(a.a)(c,2),l=i[0],j=i[1];return Object(u.jsxs)("form",{onSubmit:function(t){t.preventDefault();var r={store:n,item:l};console.log("Request Body: ",r),e.onFetchUserData(r),o(""),j("")},children:[Object(u.jsxs)("div",{className:x.a.user__controls,children:[Object(u.jsx)("div",{className:x.a.userfilter,children:Object(u.jsxs)("div",{className:x.a.user__control,children:[Object(u.jsx)("label",{children:"Store"}),Object(u.jsxs)("select",{name:"Store",value:n,onChange:function(e){o(e.target.value)},children:[Object(u.jsx)("option",{value:null,children:"All Stores"}),e.stores.map((function(e){return Object(u.jsx)("option",{value:e.store_name,children:e.store_name},e.store_id)}))]})]})}),Object(u.jsxs)("div",{className:x.a.user__control,children:[Object(u.jsx)("label",{children:"Item"}),Object(u.jsx)("input",{type:"text",value:l,onChange:function(e){j(e.target.value)}})]})]}),Object(u.jsx)("div",{className:x.a.user__actions,children:Object(u.jsx)("button",{type:"submit",children:"Search"})})]})},p=r(20),v=r.n(p),S=r(25),N=r.n(S),w=function(e){return Object(u.jsx)("div",{className:N.a.card,children:e.children})},y=r(11),F=r.n(y),C=function(e){return Object(u.jsx)("div",{className:F.a.backdrop,onClick:e.setError,children:Object(u.jsxs)(w,{className:F.a.modal,children:[Object(u.jsx)("header",{className:F.a.header,children:Object(u.jsx)("h2",{children:"Something went wrong:"})}),Object(u.jsx)("div",{className:F.a.content,children:Object(u.jsx)("p",{className:F.a.h1,children:e.message})}),Object(u.jsx)("footer",{className:F.a.actions,children:Object(u.jsx)("button",{type:"submit",onClick:e.setError,children:"Okay"})})]})})},L=function(e){var t;return t=e.error?Object(u.jsx)(C,{setError:e.setError,message:e.error}):null,Object(u.jsxs)("div",{children:[t,Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:v.a.title,children:"Search for items in a store"}),Object(u.jsx)("div",{className:v.a.user,children:Object(u.jsx)(g,{stores:e.storeNameList,onFetchUserData:function(t){var r=Object(O.a)({},t);e.onAddItems(r)}})})]})]})},k=r(7),I=r.n(k),A=function(e){var t=Object(s.useState)(""),r=Object(a.a)(t,2),n=r[0],o=r[1],c=Object(s.useState)(""),i=Object(a.a)(c,2),l=i[0],j=i[1],d=Object(s.useState)(""),m=Object(a.a)(d,2),h=m[0],b=m[1];return Object(u.jsxs)("form",{onSubmit:function(t){t.preventDefault();var r,s=n;for(var c in""==n&&(s=e.stores[0].store_name),e.stores)console.log(e.stores[c].store_name),e.stores[c].store_name===s&&(r=e.stores[c].store_id);var i={store:s,store_id:r,item:l,item_price:parseFloat(h)};console.log("Request Body: ",i),e.createItemHandler(i),o(""),j(""),b("")},children:[Object(u.jsxs)("div",{className:I.a.user__controls,children:[Object(u.jsx)("div",{className:I.a.userfilter,children:Object(u.jsxs)("div",{className:I.a.user__control,children:[Object(u.jsx)("label",{children:"Pick Store"}),Object(u.jsx)("select",{name:"Store",value:n,onChange:function(e){o(e.target.value)},children:e.stores.map((function(e){return Object(u.jsx)("option",{value:e.store_name,children:e.store_name},e.store_id)}))})]})}),Object(u.jsxs)("div",{className:I.a.user__control,children:[Object(u.jsx)("label",{children:"New Item"}),Object(u.jsx)("input",{type:"text",value:l,onChange:function(e){j(e.target.value)}})]}),Object(u.jsxs)("div",{className:I.a.user__control,children:[Object(u.jsx)("label",{children:"New Item Price"}),Object(u.jsx)("input",{type:"text",value:h,onChange:function(e){b(e.target.value)}})]})]}),Object(u.jsx)("div",{className:I.a.user__actions,children:Object(u.jsx)("button",{type:"submit",children:"Add Item"})})]})},E=function(e){var t=Object(s.useState)(""),r=Object(a.a)(t,2),n=r[0],o=r[1];return Object(u.jsxs)("form",{onSubmit:function(t){t.preventDefault();var r={store:n};console.log("Request Body: ",r),e.createStoreHandler(r),o("")},children:[Object(u.jsx)("div",{className:I.a.user__controls,children:Object(u.jsx)("div",{className:I.a.userfilter,children:Object(u.jsxs)("div",{className:I.a.user__control,children:[Object(u.jsx)("label",{children:"New Store"}),Object(u.jsx)("input",{type:"text",value:n,onChange:function(e){o(e.target.value)}})]})})}),Object(u.jsx)("div",{className:I.a.user__actions,children:Object(u.jsx)("button",{type:"submit",children:"Add Store"})})]})},T=r(16),H=r.n(T),D=function(e){var t;return t=e.error?Object(u.jsx)(C,{setError:e.setError,message:e.error}):null,Object(u.jsxs)("div",{children:[t,Object(u.jsx)("h1",{className:H.a.title,children:"Add an item to an existing store"}),Object(u.jsx)("div",{className:H.a.user,children:Object(u.jsx)(A,{stores:e.stores,createItemHandler:function(t){var r=Object(O.a)({},t);e.createItemHandler(r)}})}),Object(u.jsx)("h1",{className:H.a.title,children:"Add a new store"}),Object(u.jsx)("div",{className:H.a.user,children:Object(u.jsx)(E,{setError:e.setError,updateStoreListHandler:e.updateStoreListHandler,createStoreHandler:function(t){var r=Object(O.a)({},t);e.createStoreHandler(r)}})})]})},P=(r(36),n.a.createContext({token:"",isLoggedIn:!1,login:function(e){},logout:function(){}})),U=function(e){var t=localStorage.getItem("token"),r=Object(s.useState)(t),n=Object(a.a)(r,2),o=n[0],c=n[1],i=!!o,l=Object(s.useCallback)((function(){c(null),localStorage.removeItem("token"),localStorage.removeItem("deadLine"),clearTimeout(b)}),[]);Object(s.useEffect)((function(){if(o){var e=localStorage.getItem("deadLine")-Date.now();e<6e3&&(e=0),b=setTimeout(l,e),console.log("Time left in user session: ",e)}}),[o,l]);var j={token:o,isLoggedIn:i,login:function(e,t){localStorage.setItem("token",e),localStorage.setItem("deadLine",t),b=setTimeout(l,t-Date.now()),c(e)},logout:l};return Object(u.jsx)(P.Provider,{value:j,children:e.children})},J=P,R=function(){var e=Object(s.useContext)(J),t=e.isLoggedIn,r=Object(l.f)();return Object(u.jsx)("header",{className:"header",children:Object(u.jsxs)("nav",{children:[!t&&Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{activeClassName:"active",exact:!0,to:"/",children:"Search"})}),Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{activeClassName:"active",to:"/login",children:"Login"})})]}),t&&Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{activeClassName:"active",exact:!0,to:"/",children:"Search"})}),Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{activeClassName:"active",to:"/admin",children:"Admin"})}),Object(u.jsx)("li",{children:Object(u.jsx)("button",{type:"button",onClick:function(){e.logout(),r.replace("/")},children:"Logout"})})]})]})})},M=r(27),q=r.n(M),B=function(){return Object(u.jsx)("div",{className:q.a.loader,children:"Loading..."})},W=r(12),z=r.n(W),Q=function(e){var t=Object(l.f)(),r=Object(s.useRef)(),n=Object(s.useRef)(),o=Object(s.useContext)(J),c=Object(s.useState)(!0),i=Object(a.a)(c,2),j=i[0],d=i[1],m=Object(s.useState)(!1),h=Object(a.a)(m,2),b=h[0],_=h[1];console.log("isLogin ",j);var O,f=function(){d((function(e){return!e}))};return O=e.error?Object(u.jsx)(C,{setError:e.errorHandler,message:e.error}):null,Object(u.jsxs)("div",{children:[O,Object(u.jsx)("h1",{className:z.a.title,children:"Login or create new user to add new items or stores"}),Object(u.jsxs)("section",{className:z.a.auth,children:[Object(u.jsx)("h1",{children:j?"Login":"Sign Up"}),Object(u.jsxs)("form",{onSubmit:function(s){s.preventDefault();var c=r.current.value,i=n.current.value;j?(_(!0),fetch("https://store-item-restful-api.herokuapp.com/auth",{method:"POST",body:JSON.stringify({username:c,password:i}),headers:{"Content-Type":"application/json"}}).then((function(e){return console.log("response",e),e.json()})).then((function(e){if(console.log("Auth response ",e,e.description),e.description)throw new Error(e.description);setTimeout((function(){_(!1)}),2e3),console.log("JWT ",e.access_token),o.login(e.access_token,Date.now()+36e5),t.replace("/admin")})).catch((function(t){return e.setError(t.message)}))):(_(!0),fetch("https://store-item-restful-api.herokuapp.com/register",{method:"POST",body:JSON.stringify({username:c,password:i}),headers:{"Content-Type":"application/json"}}).then((function(e){return _(!1),console.log("response",e),e.json()})).then((function(e){if(console.log("Signup response ",e),e.message&&"User created succesfully"!==e.message)throw new Error(e.message);t.replace("/login"),f(),alert("User created succesfully. Please login!")})).catch((function(t){return e.setError(t.message)})))},children:[Object(u.jsxs)("div",{className:z.a.control,children:[Object(u.jsx)("label",{htmlFor:"username",children:"Username"}),Object(u.jsx)("input",{type:"username",id:"username",required:!0,ref:r})]}),Object(u.jsxs)("div",{className:z.a.control,children:[Object(u.jsx)("label",{htmlFor:"password",children:"Password"}),Object(u.jsx)("input",{type:"password",id:"password",required:!0,ref:n})]}),Object(u.jsxs)("div",{className:z.a.actions,children:[!b&&Object(u.jsx)("button",{children:j?"Login":"Create Account"}),b&&Object(u.jsx)(B,{}),Object(u.jsx)("button",{type:"button",className:z.a.toggle,onClick:f,children:j?"Create new account":"Login with existing account"})]})]})]})]})};var X=function(){var e=Object(s.useContext)(J),t=Object(s.useState)([]),r=Object(a.a)(t,2),n=r[0],o=r[1],c=Object(s.useState)([]),i=Object(a.a)(c,2),j=i[0],d=i[1],m=Object(s.useState)(!1),h=Object(a.a)(m,2),b=h[0],O=h[1],f=Object(s.useState)(!1),x=Object(a.a)(f,2),g=x[0],p=x[1],v=Object(s.useState)(null),S=Object(a.a)(v,2),N=S[0],w=S[1];Object(s.useEffect)((function(){fetch("https://store-item-restful-api.herokuapp.com/stores").then((function(e){return e.json()})).then((function(e){if(e.message)throw new Error(e.message);console.log("useEffect read stores response",e.items),d(e.items)})).catch((function(e){return w(e.message)}))}),[b]),console.log("Updated store dropdown list",j);var y=function(){w(null)};return Object(u.jsxs)("div",{children:[Object(u.jsx)(R,{}),Object(u.jsxs)("main",{children:[Object(u.jsx)(l.b,{exact:!0,path:"/",children:Object(u.jsxs)("div",{children:[Object(u.jsx)(L,{setError:y,error:N,storeNameList:j,onAddItems:function(e){var t=[];return console.log(e),p(!0),w(null),0==e.store.trim().length&&0==e.item.trim().length&&(w("Enter an item to check across all stores"),p(!1)),e.store.trim().length>0&&e.item.trim().length>0?(console.log("a store and item value were entered by the user"),fetch("https://store-item-restful-api.herokuapp.com/store/".concat(e.store,"/").concat(e.item)).then((function(e){return console.log("response",e),e.json()})).then((function(e){if(e.message)throw new Error(e.message);t.push(e),o(t),console.log(n)})).catch((function(e){return w(e.message)})),setTimeout((function(){p(!1)}),2e3),void console.log("Displaying items state",n)):e.store.trim().length>0&&0==e.item.trim().length?(console.log("only a store value was entered by the user",e.store),fetch("https://store-item-restful-api.herokuapp.com/store/".concat(e.store)).then((function(e){return console.log("response",e),e.json()})).then((function(e){if(e.message)throw new Error(e.message);console.log(e),o(e.items)})).catch((function(e){return w(e.message)})),setTimeout((function(){p(!1)}),2e3),void console.log("Displaying items state",n)):0==e.store.trim().length&&e.item.trim().length>0?(console.log("only an item value was entered by the user"),fetch("https://store-item-restful-api.herokuapp.com/item/".concat(e.item)).then((function(e){return console.log("response",e),e.json()})).then((function(e){if(e.message)throw new Error(e.message);console.log(e),o(e)})).catch((function(e){return w(e.message)})),setTimeout((function(){p(!1)}),2e3),void console.log("Displaying items state",n)):void 0}}),!g&&n.length>0&&Object(u.jsx)(_,{items:n}),!g&&0===n.length&&!N&&Object(u.jsx)("p",{children:"Found no items"}),g&&Object(u.jsx)(B,{}),!g&&N&&Object(u.jsx)("p",{children:N})]})}),!e.isLoggedIn&&Object(u.jsx)(l.b,{path:"/login",children:Object(u.jsx)(Q,{error:N,setError:w,errorHandler:y})}),e.isLoggedIn&&Object(u.jsx)(l.b,{path:"/admin",children:Object(u.jsx)(D,{setError:y,error:N,createItemHandler:function(t){fetch("https://store-item-restful-api.herokuapp.com/item/".concat(t.item),{method:"POST",body:JSON.stringify({item_price:t.item_price,store_id:t.store_id,store_name:t.store}),headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(e.token)}}).then((function(e){return console.log("response",e),e.json()})).then((function(e){if(e.message)throw new Error(e.message);alert("New store item created succesfully. You can now search for it!")})).catch((function(e){return w(e.message)}))},stores:j,createStoreHandler:function(t){console.log(t.store),fetch("https://store-item-restful-api.herokuapp.com/store/".concat(t.store),{method:"POST",body:null,headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(e.token)}}).then((function(e){return O((function(e){return!e})),e.json()})).then((function(e){if(e.message)throw new Error(e.message);alert("New store created succesfully. You can now search for it!")})).catch((function(e){return w(e.message)})),p(!1)}})}),e.isLoggedIn&&Object(u.jsx)(l.b,{path:"*",children:Object(u.jsx)(l.a,{to:"/admin"})}),!e.isLoggedIn&&Object(u.jsx)(l.b,{path:"*",children:Object(u.jsx)(l.a,{to:"/"})})]})]})},Y=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,43)).then((function(t){var r=t.getCLS,s=t.getFID,n=t.getFCP,o=t.getLCP,c=t.getTTFB;r(e),s(e),n(e),o(e),c(e)}))};i.a.render(Object(u.jsx)(U,{children:Object(u.jsx)(n.a.StrictMode,{children:Object(u.jsx)(o.a,{children:Object(u.jsx)(X,{})})})}),document.getElementById("root")),Y()}],[[42,1,2]]]);
//# sourceMappingURL=main.f922c6aa.chunk.js.map